<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Modular Application Creator Use Case Based Documentation: MAC_use_cases.Model.UseCases.HardwareGenerationExcelBased Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Modular Application Creator Use Case Based Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('class_m_a_c__use__cases_1_1_model_1_1_use_cases_1_1_hardware_generation_excel_based.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="class_m_a_c__use__cases_1_1_model_1_1_use_cases_1_1_hardware_generation_excel_based-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">MAC_use_cases.Model.UseCases.HardwareGenerationExcelBased Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Handles the generation of hardware configurations based on Excel file inputs. This class provides functionality to read device information from Excel sheets and create corresponding hardware configurations in TIA Portal projects.  
 <a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_a_c__use__cases_1_1_model_1_1_use_cases_1_1_hardware_generation_excel_based_1_1_device_info.html">DeviceInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents device information read from the Excel file.  <a href="class_m_a_c__use__cases_1_1_model_1_1_use_cases_1_1_hardware_generation_excel_based_1_1_device_info.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a5a17bbc5dd169fdfeeb4189aebcc8c68" id="r_a5a17bbc5dd169fdfeeb4189aebcc8c68"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a17bbc5dd169fdfeeb4189aebcc8c68">CreateNewDevicesFromExcelSheet</a> (<a class="el" href="class_m_a_c__use__cases_1_1_model_1_1_m_a_c__use__cases_e_m.html">MAC_use_casesEM</a> module, Project tiaProject, string excelFilePath)</td></tr>
<tr class="memdesc:a5a17bbc5dd169fdfeeb4189aebcc8c68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates new devices in the TIA Portal project based on information from an Excel sheet.  <br /></td></tr>
<tr class="separator:a5a17bbc5dd169fdfeeb4189aebcc8c68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-methods" name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a0c92961530071d38658c8c10bec08339" id="r_a0c92961530071d38658c8c10bec08339"><td class="memItemLeft" align="right" valign="top">static List&lt; <a class="el" href="class_m_a_c__use__cases_1_1_model_1_1_use_cases_1_1_hardware_generation_excel_based_1_1_device_info.html">DeviceInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c92961530071d38658c8c10bec08339">ReadExcelFile</a> (string filePath)</td></tr>
<tr class="memdesc:a0c92961530071d38658c8c10bec08339"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads device information from a specified Excel file.  <br /></td></tr>
<tr class="separator:a0c92961530071d38658c8c10bec08339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f684b029e82b0902a37e7f100579fa6" id="r_a7f684b029e82b0902a37e7f100579fa6"><td class="memItemLeft" align="right" valign="top">static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f684b029e82b0902a37e7f100579fa6">GetCellValueAsString</a> (Excel.Range cell)</td></tr>
<tr class="memdesc:a7f684b029e82b0902a37e7f100579fa6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an Excel cell value to a string, handling null values.  <br /></td></tr>
<tr class="separator:a7f684b029e82b0902a37e7f100579fa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Handles the generation of hardware configurations based on Excel file inputs. This class provides functionality to read device information from Excel sheets and create corresponding hardware configurations in TIA Portal projects. </p>

<p class="definition">Definition at line <a class="el" href="_hardware_generation_excel_based_8cs_source.html#l00017">17</a> of file <a class="el" href="_hardware_generation_excel_based_8cs_source.html">HardwareGenerationExcelBased.cs</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a0c92961530071d38658c8c10bec08339" name="a0c92961530071d38658c8c10bec08339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c92961530071d38658c8c10bec08339">&#9670;&#160;</a></span>ReadExcelFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static List&lt; <a class="el" href="class_m_a_c__use__cases_1_1_model_1_1_use_cases_1_1_hardware_generation_excel_based_1_1_device_info.html">DeviceInfo</a> &gt; MAC_use_cases.Model.UseCases.HardwareGenerationExcelBased.ReadExcelFile </td>
          <td>(</td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>filePath</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads device information from a specified Excel file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filePath</td><td>The full path to the Excel file containing device information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A list of <a class="el" href="class_m_a_c__use__cases_1_1_model_1_1_use_cases_1_1_hardware_generation_excel_based_1_1_device_info.html" title="Represents device information read from the Excel file.">DeviceInfo</a> objects containing the parsed device information.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Exception</td><td>Thrown when required columns are missing in the Excel file.</td></tr>
  </table>
  </dd>
</dl>
<p>The Excel file must contain the following required columns:</p><ul>
<li>OrderNumber</li>
<li>Version</li>
<li>Name</li>
<li>DeviceName The "Type" column is optional. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="_hardware_generation_excel_based_8cs_source.html#l00033">33</a> of file <a class="el" href="_hardware_generation_excel_based_8cs_source.html">HardwareGenerationExcelBased.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   34</span>    {</div>
<div class="line"><span class="lineno">   35</span>        var devices = <span class="keyword">new</span> List&lt;DeviceInfo&gt;();</div>
<div class="line"><span class="lineno">   36</span>        Excel.Application xlApp = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">   37</span>        Excel.Workbook xlWorkbook = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">   38</span>        Excel.Worksheet xlWorksheet = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">   39</span>        Excel.Range xlRange = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>        <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">   42</span>        {</div>
<div class="line"><span class="lineno">   43</span>            xlApp = <span class="keyword">new</span> Excel.Application();</div>
<div class="line"><span class="lineno">   44</span>            xlWorkbook = xlApp.Workbooks.Open(filePath);</div>
<div class="line"><span class="lineno">   45</span>            xlWorksheet = xlWorkbook.Sheets[1];</div>
<div class="line"><span class="lineno">   46</span>            xlRange = xlWorksheet.UsedRange;</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>            var rowCount = xlRange.Rows.Count;</div>
<div class="line"><span class="lineno">   49</span>            var colCount = xlRange.Columns.Count;</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>            <span class="comment">// Create a mapping of column indices to ensure flexibility in column order</span></div>
<div class="line"><span class="lineno">   52</span>            var columnMap = <span class="keyword">new</span> Dictionary&lt;string, int&gt;();</div>
<div class="line"><span class="lineno">   53</span>            <span class="keywordflow">for</span> (var j = 1; j &lt;= colCount; j++)</div>
<div class="line"><span class="lineno">   54</span>            {</div>
<div class="line"><span class="lineno">   55</span>                <span class="keywordflow">if</span> (xlRange.Cells[1, j].Value2 != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">   56</span>                {</div>
<div class="line"><span class="lineno">   57</span>                    columnMap[xlRange.Cells[1, j].Value2.ToString()] = j;</div>
<div class="line"><span class="lineno">   58</span>                }</div>
<div class="line"><span class="lineno">   59</span>            }</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>            <span class="comment">// Validate required columns exist (excluding Type as it&#39;s optional)</span></div>
<div class="line"><span class="lineno">   62</span>            <span class="keywordtype">string</span>[] requiredColumns = { <span class="stringliteral">&quot;OrderNumber&quot;</span>, <span class="stringliteral">&quot;Version&quot;</span>, <span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;DeviceName&quot;</span> };</div>
<div class="line"><span class="lineno">   63</span>            <span class="keywordflow">foreach</span> (var column <span class="keywordflow">in</span> requiredColumns)</div>
<div class="line"><span class="lineno">   64</span>            {</div>
<div class="line"><span class="lineno">   65</span>                <span class="keywordflow">if</span> (!columnMap.ContainsKey(column))</div>
<div class="line"><span class="lineno">   66</span>                {</div>
<div class="line"><span class="lineno">   67</span>                    <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception($<span class="stringliteral">&quot;Required column &#39;{column}&#39; not found in Excel file&quot;</span>);</div>
<div class="line"><span class="lineno">   68</span>                }</div>
<div class="line"><span class="lineno">   69</span>            }</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>            <span class="comment">// Read data rows</span></div>
<div class="line"><span class="lineno">   72</span>            <span class="keywordflow">for</span> (var i = 2; i &lt;= rowCount; i++) <span class="comment">// Start from row 2 to skip headers</span></div>
<div class="line"><span class="lineno">   73</span>            {</div>
<div class="line"><span class="lineno">   74</span>                <span class="keywordflow">if</span> (xlRange.Cells[i, columnMap[<span class="stringliteral">&quot;OrderNumber&quot;</span>]].Value2 == <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">   75</span>                {</div>
<div class="line"><span class="lineno">   76</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   77</span>                }</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>                var device = <span class="keyword">new</span> DeviceInfo</div>
<div class="line"><span class="lineno">   80</span>                {</div>
<div class="line"><span class="lineno">   81</span>                    OrderNumber = GetCellValueAsString(xlRange.Cells[i, columnMap[<span class="stringliteral">&quot;OrderNumber&quot;</span>]]),</div>
<div class="line"><span class="lineno">   82</span>                    Version = GetCellValueAsString(xlRange.Cells[i, columnMap[<span class="stringliteral">&quot;Version&quot;</span>]]),</div>
<div class="line"><span class="lineno">   83</span>                    Name = GetCellValueAsString(xlRange.Cells[i, columnMap[<span class="stringliteral">&quot;Name&quot;</span>]]),</div>
<div class="line"><span class="lineno">   84</span>                    DeviceName = GetCellValueAsString(xlRange.Cells[i, columnMap[<span class="stringliteral">&quot;DeviceName&quot;</span>]])</div>
<div class="line"><span class="lineno">   85</span>                };</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>                <span class="comment">// Handle Type column separately as it&#39;s optional</span></div>
<div class="line"><span class="lineno">   88</span>                <span class="keywordflow">if</span> (columnMap.TryGetValue(<span class="stringliteral">&quot;Type&quot;</span>, out var value))</div>
<div class="line"><span class="lineno">   89</span>                {</div>
<div class="line"><span class="lineno">   90</span>                    device.Type = GetCellValueAsString(xlRange.Cells[i, value]);</div>
<div class="line"><span class="lineno">   91</span>                }</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>                <span class="comment">// Only add device if required fields are not empty</span></div>
<div class="line"><span class="lineno">   94</span>                <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrWhiteSpace(device.OrderNumber) &amp;&amp;</div>
<div class="line"><span class="lineno">   95</span>                    !<span class="keywordtype">string</span>.IsNullOrWhiteSpace(device.Version) &amp;&amp;</div>
<div class="line"><span class="lineno">   96</span>                    !<span class="keywordtype">string</span>.IsNullOrWhiteSpace(device.Name) &amp;&amp;</div>
<div class="line"><span class="lineno">   97</span>                    !<span class="keywordtype">string</span>.IsNullOrWhiteSpace(device.DeviceName))</div>
<div class="line"><span class="lineno">   98</span>                {</div>
<div class="line"><span class="lineno">   99</span>                    devices.Add(device);</div>
<div class="line"><span class="lineno">  100</span>                }</div>
<div class="line"><span class="lineno">  101</span>            }</div>
<div class="line"><span class="lineno">  102</span>        }</div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">finally</span></div>
<div class="line"><span class="lineno">  104</span>        {</div>
<div class="line"><span class="lineno">  105</span>            <span class="comment">// Clean up COM objects</span></div>
<div class="line"><span class="lineno">  106</span>            <span class="keywordflow">if</span> (xlRange != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  107</span>            {</div>
<div class="line"><span class="lineno">  108</span>                Marshal.ReleaseComObject(xlRange);</div>
<div class="line"><span class="lineno">  109</span>            }</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>            <span class="keywordflow">if</span> (xlWorksheet != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  112</span>            {</div>
<div class="line"><span class="lineno">  113</span>                Marshal.ReleaseComObject(xlWorksheet);</div>
<div class="line"><span class="lineno">  114</span>            }</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>            <span class="keywordflow">if</span> (xlWorkbook != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  117</span>            {</div>
<div class="line"><span class="lineno">  118</span>                xlWorkbook.Close(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  119</span>                Marshal.ReleaseComObject(xlWorkbook);</div>
<div class="line"><span class="lineno">  120</span>            }</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>            <span class="keywordflow">if</span> (xlApp != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  123</span>            {</div>
<div class="line"><span class="lineno">  124</span>                xlApp.Quit();</div>
<div class="line"><span class="lineno">  125</span>                Marshal.ReleaseComObject(xlApp);</div>
<div class="line"><span class="lineno">  126</span>            }</div>
<div class="line"><span class="lineno">  127</span>        }</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">return</span> devices;</div>
<div class="line"><span class="lineno">  130</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f684b029e82b0902a37e7f100579fa6" name="a7f684b029e82b0902a37e7f100579fa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f684b029e82b0902a37e7f100579fa6">&#9670;&#160;</a></span>GetCellValueAsString()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static string MAC_use_cases.Model.UseCases.HardwareGenerationExcelBased.GetCellValueAsString </td>
          <td>(</td>
          <td class="paramtype">Excel.Range</td>          <td class="paramname"><span class="paramname"><em>cell</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Converts an Excel cell value to a string, handling null values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cell</td><td>The Excel range cell to read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The cell value as a trimmed string, or empty string if the cell is null.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_hardware_generation_excel_based_8cs_source.html#l00137">137</a> of file <a class="el" href="_hardware_generation_excel_based_8cs_source.html">HardwareGenerationExcelBased.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  138</span>    {</div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">return</span> cell?.Value2 == <span class="keyword">null</span> ? string.Empty : (string)cell.Value2.ToString().Trim();</div>
<div class="line"><span class="lineno">  140</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a17bbc5dd169fdfeeb4189aebcc8c68" name="a5a17bbc5dd169fdfeeb4189aebcc8c68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a17bbc5dd169fdfeeb4189aebcc8c68">&#9670;&#160;</a></span>CreateNewDevicesFromExcelSheet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void MAC_use_cases.Model.UseCases.HardwareGenerationExcelBased.CreateNewDevicesFromExcelSheet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_m_a_c__use__cases_1_1_model_1_1_m_a_c__use__cases_e_m.html">MAC_use_casesEM</a></td>          <td class="paramname"><span class="paramname"><em>module</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Project</td>          <td class="paramname"><span class="paramname"><em>tiaProject</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>excelFilePath</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates new devices in the TIA Portal project based on information from an Excel sheet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">module</td><td>The MAC use cases module instance.</td></tr>
    <tr><td class="paramname">tiaProject</td><td>The target TIA Portal project.</td></tr>
    <tr><td class="paramname">excelFilePath</td><td>Path to the Excel file containing device specifications.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FileNotFoundException</td><td>Thrown when the specified Excel file is not found.</td></tr>
    <tr><td class="paramname">Exception</td><td>Thrown when there's an error in creating devices from the Excel file.</td></tr>
  </table>
  </dd>
</dl>
<p>This method:</p><ul>
<li>Validates the Excel file existence</li>
<li>Reads device information from the Excel file</li>
<li>Creates devices in the TIA Portal project</li>
<li>Logs the progress and any errors that occur during device creation </li>
</ul>

<p class="definition">Definition at line <a class="el" href="_hardware_generation_excel_based_8cs_source.html#l00157">157</a> of file <a class="el" href="_hardware_generation_excel_based_8cs_source.html">HardwareGenerationExcelBased.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  158</span>    {</div>
<div class="line"><span class="lineno">  159</span>        <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  160</span>        {</div>
<div class="line"><span class="lineno">  161</span>            <span class="keywordflow">if</span> (!File.Exists(excelFilePath))</div>
<div class="line"><span class="lineno">  162</span>            {</div>
<div class="line"><span class="lineno">  163</span>                <span class="keywordflow">throw</span> <span class="keyword">new</span> FileNotFoundException(<span class="stringliteral">&quot;Excel file not found&quot;</span>, excelFilePath);</div>
<div class="line"><span class="lineno">  164</span>            }</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>            var deviceInfos = ReadExcelFile(excelFilePath);</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>            <span class="keywordflow">foreach</span> (var deviceInfo <span class="keywordflow">in</span> deviceInfos)</div>
<div class="line"><span class="lineno">  169</span>            {</div>
<div class="line"><span class="lineno">  170</span>                <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  171</span>                {</div>
<div class="line"><span class="lineno">  172</span>                    MacManagement.LoggingService.LogMessage(LogTypes.GenerationInfo,</div>
<div class="line"><span class="lineno">  173</span>                        $<span class="stringliteral">&quot;Processing device: {deviceInfo}&quot;</span>, module.Name);</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>                    var typeIdentifier = <span class="keywordtype">string</span>.IsNullOrWhiteSpace(deviceInfo.Type)</div>
<div class="line"><span class="lineno">  176</span>                        ? $<span class="stringliteral">&quot;OrderNumber:{deviceInfo.OrderNumber}/{deviceInfo.Version}&quot;</span></div>
<div class="line"><span class="lineno">  177</span>                        : $<span class="stringliteral">&quot;OrderNumber:{deviceInfo.OrderNumber}/{deviceInfo.Version}/{deviceInfo.Type}&quot;</span>;</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>                    MacManagement.LoggingService.LogMessage(LogTypes.GenerationInfo,</div>
<div class="line"><span class="lineno">  180</span>                        $<span class="stringliteral">&quot;Creating device with identifier: {typeIdentifier}&quot;</span>, module.Name);</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>                    HardwareGeneration.GetOrCreateDevice(tiaProject, typeIdentifier, deviceInfo.Name,</div>
<div class="line"><span class="lineno">  183</span>                        deviceInfo.DeviceName);</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>                    MacManagement.LoggingService.LogMessage(LogTypes.GenerationInfo,</div>
<div class="line"><span class="lineno">  186</span>                        $<span class="stringliteral">&quot;Successfully added device: {deviceInfo.DeviceName}&quot;</span>, module.Name);</div>
<div class="line"><span class="lineno">  187</span>                }</div>
<div class="line"><span class="lineno">  188</span>                <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line"><span class="lineno">  189</span>                {</div>
<div class="line"><span class="lineno">  190</span>                    MacManagement.LoggingService.LogMessage(LogTypes.GenerationError,</div>
<div class="line"><span class="lineno">  191</span>                        $<span class="stringliteral">&quot;Failed to process device {deviceInfo}. Error: {ex.Message}&quot;</span>, module.Name);</div>
<div class="line"><span class="lineno">  192</span>                }</div>
<div class="line"><span class="lineno">  193</span>            }</div>
<div class="line"><span class="lineno">  194</span>        }</div>
<div class="line"><span class="lineno">  195</span>        <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line"><span class="lineno">  196</span>        {</div>
<div class="line"><span class="lineno">  197</span>            <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception($<span class="stringliteral">&quot;Error creating devices from Excel file: {ex.Message}&quot;</span>, ex);</div>
<div class="line"><span class="lineno">  198</span>        }</div>
<div class="line"><span class="lineno">  199</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>MAC_use_cases/Model/UseCases/<a class="el" href="_hardware_generation_excel_based_8cs_source.html">HardwareGenerationExcelBased.cs</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_m_a_c__use__cases.html">MAC_use_cases</a></li><li class="navelem"><a class="el" href="namespace_m_a_c__use__cases_1_1_model.html">Model</a></li><li class="navelem"><a class="el" href="namespace_m_a_c__use__cases_1_1_model_1_1_use_cases.html">UseCases</a></li><li class="navelem"><a class="el" href="class_m_a_c__use__cases_1_1_model_1_1_use_cases_1_1_hardware_generation_excel_based.html">HardwareGenerationExcelBased</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
